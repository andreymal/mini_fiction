<!DOCTYPE html>
<html lang="{{ g.locale.language }}">
<head>
    <meta charset="utf-8" />
    <title>
        {%- block fulltitle -%}
            {% block title %}{{ page_title }}{% endblock %} &mdash; {{ SITE_NAME }}
        {%- endblock fulltitle -%}
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes" />
{%- block favicon %}
    {% if config['FAVICON_URL'] -%}
        <link rel="shortcut icon" type="image/x-icon" href="{{ config['FAVICON_URL'] }}" />
    {%- endif %}
{% endblock -%}

{%- block meta_csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token() }}" />
{% endblock -%}

{%- block head_css %}
    {% set index_css, story_css = webpack_asset('index.css'), webpack_asset('story.css') %}
    <link rel="stylesheet" href="{{ url_for('static', filename='build/{}'.format(index_css.src)) }}" integrity="{{ index_css.integrity }}" crossorigin="anonymous"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='build/{}'.format(story_css.src)) }}" integrity="{{ story_css.integrity }}" crossorigin="anonymous"/>
    {%- for css_link in extra_css %}
        <link rel="stylesheet" href="{{ css_link }}" />
    {%- endfor -%}
{% endblock -%}

{% for script in webpack_scripts() %}
    <link rel="prefetch" as="script" href="{{ url_for('static', filename='build/{}'.format(script.src)) }}" integrity="{{ script.integrity }}">
{% endfor %}

{% set index_js, bootstrap_js = webpack_asset('index.js'), webpack_asset('bootstrap.js') %}
<script defer src="{{ url_for('static', filename='build/{}'.format(index_js.src)) }}" integrity="{{ index_js.integrity }}" crossorigin="anonymous"></script>
<script defer src="{{ url_for('static', filename='build/{}'.format(bootstrap_js.src)) }}" integrity="{{ bootstrap_js.integrity }}" crossorigin="anonymous"></script>


{%- block meta_robots_tag %}{% if robots_noindex or robots_nofollow %}
    <meta name="robots" content="
    {%- if robots_noindex -%}noindex{%- else -%}index{%- endif -%}
    , {% if robots_nofollow -%}nofollow{%- else -%}follow{%- endif -%}" />
{% endif %}{% endblock -%}

{%- block html_block_head %}
    {{ html_block('head') }}
{%- endblock -%}

{% block extrahead %}{% endblock %}
</head>

<body>
    <!-- Container start -->
    <div class="container">
    {% include 'includes/header.html' with context %}
    <!-- Content start -->
    <main id="content">

    {%- block content %}{% endblock -%}

    </main>
    <!-- Content end -->
    <footer class="footer">{{ html_block('footer') }}</footer>
    </div>
    <!-- Container end -->

    <div class="modal-backdrop hide fade" id="modal-bg"></div>
    <div class="modal hide fade" id="modal">{% block modal %}{% endblock %}</div>
    <div id="loading-icon" class="loader-container loader loader-hidden"></div>
    <div class="popup-notifications" id="popup-notifications"></div>
{% include 'includes/formatting_window.html' %}
{% include 'base_body_scripts.html' %}
{% block extrabody %}{% endblock %}
</body>
</html>
