{%- from 'experimental/macro.html' import character_picture -%}
{%- from 'experimental/macro.html' import tag_link -%}

{% for random_story in random_stories %}
    <input {% if loop.index == 1 %}checked autofocus{% endif %}
           type="radio" id="slide-trigger-{{ loop.index }}" name="slider">
    <label for="slide-trigger-{{ loop.index }}"></label>
    <div class="slide">
        <h3><a href="{{ url_for('story.view', pk=random_story.id) }}">{{ random_story.title }}</a></h3>
        <p>
            <span class="tags">
                {%- for st in random_story.bl.get_tags_list(sort=True) %}
                    {% if st.tag.is_main_tag %}{{ tag_link(st.tag) -}}{% endif %}
                {% endfor -%}
            </span>
        </p>
        <p>{{ random_story.summary|striptags }}</p>
        <p>
            <span class="characters">
                {%- for character in random_story.characters|sort(attribute='id') -%}
                    <a href="{{ url_for('search.simple', search_type='character', search_id=character.id) }}">{{ character_picture(character) }}</a>
                {%- endfor -%}
            </span>
        </p>
    </div>
{% endfor %}
